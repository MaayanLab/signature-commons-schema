{
  "$id": "/@dcic/signature-commons-schema/meta/signature/draft-1.json",
  "$schema": "http://json-schema.org/draft-04/schema#",
  "allOf": [
    {
      "$ref": "/@dcic/signature-commons-schema/core/meta.json"
    },
    {
      "type": "object",
      "properties": {
        "Accession": {
          "description": "External accession of the signature",
          "type": "array",
          "items": {
            "type": "object",
            "properties": {
              "ID": {
                "description": "External identifier",
                "type": "string"
              },
              "Type": {
                "description": "The type of the identifier",
                "type": "string",
                "enum": [
                  "ArrayExpress Accession",
                  "GEO Dataset Accession",
                  "GEO Platform Accession",
                  "GEO Series Accession",
                  "MGS ID",
                  "NCI PID UUID",
                  "Grant Number"
                ]
              }
            },
            "required": [
              "ID",
              "Type"
            ]
          }
        },
        "Age": {
          "description": "Age/ age group of the subjects",
          "type": "string"
        },
        "Authors": {
          "description": "The authors involved with the signature.",
          "type": "string"
        },
        "Batch": {
          "description": "The batch",
          "type": "string"
        },
        "Brain Region": {
          "description": "Region of the brain where the samples were harvested",
          "type": "string"
        },
        "Breed": {
          "description": "Breed of the sample",
          "type": "string"
        },
        "Category Code": {
          "description": "Category code of the gene set.",
          "type": "string"
        },
        "Cell Line": {
          "description": "The cell line context",
          "type": "array",
          "items": {
            "type": "object",
            "properties": {
              "Name": {
                "description": "Official name of cell line",
                "type": "string"
              },
              "Accession": {
                "description": "Ontology accession",
                "type": "string"
              }
            },
            "required": [
              "Name"
            ]
          }
        },
        "Cellular Compartment": {
          "description": "Subcellular localization information",
          "type": "string"
        },
        "Chip": {
          "description": "Source platform",
          "type": "string"
        },
        "Chromosome Location": {
          "description": "Location in the chromosome",
          "type": "string"
        },
        "Complex": {
          "description": "Protein complexes",
          "type": "string"
        },
        "Complex ID": {
          "description": "Complex Identifier",
          "type": "string"
        },
        "Contributor": {
          "description": "Names of the contributors",
          "type": "string"
        },
        "Contributor Org": {
          "description": "Contributing organization",
          "type": "string"
        },
        "Description": {
          "description": "Description of the signature",
          "type": "string"
        },
        "Direction": {
          "type": "string",
          "description": "Tells whether the data are up regulated or down regulated",
          "enum": [
            "up",
            "down"
          ]
        },
        "Disease": {
          "$ref": "/@dcic/signature-commons-schema/meta/signature/perturbation/disease.json",
          "description": "Disease perturbations"
        },
        "Experimental Group": {
          "description": "The group being measured",
          "type": "string"
        },
        "Exact Source": {
          "description": "Source of the Gene set",
          "type": "string"
        },
        "External Details Url": {
          "description": "External link for more details",
          "format": "uri",
          "type": "string"
        },
        "Gene": {
          "$ref": "/@dcic/signature-commons-schema/meta/signature/perturbation/gene.json",
          "description": "Gene perturbations"
        },
        "Gene Set": {
          "description": "Name of the gene set",
          "type": "string"
        },
        "GO": {
          "description": "Gene ontology annotations",
          "type": "object",
          "properties": {
            "GOID": {
              "description": "Gene ontology ID",
              "pattern": "GO:[0-9]+",
              "type": "string"
            },
            "Biological Process": {
              "description": "GO Biological Process.",
              "type": "string"
            },
            "Cellular Component": {
              "description": "GO Cellular Component",
              "type": "string"
            },
            "Molecular Function": {
              "description": "GO molecular funtion",
              "type": "string"
            },
            "required": [
              "GOID"
            ],
            "oneOf": [
              {
                "required": [
                  "GOID",
                  "Biological Process"
                ]
              },
              {
                "required": [
                  "GOID",
                  "Cellular Component"
                ]
              },
              {
                "required": [
                  "GOID",
                  "Molecular Function"
                ]
              }
            ]
          }
        },
        "Gene Family": {
          "description": "The family of genes (TODO: validate against official list)",
          "type": "string"
        },
        "Genome Build": {
          "description": "Genome assembly build",
          "type": "string"
        },
        "Library": {
          "description": "Enrichr Library",
          "type": "string"
        },
        "Metabolite": {
          "description": "The metabolite.",
          "type": "object",
          "properties": {
            "Name": {
              "description": "Name of the metabolite",
              "type": "string"
            },
            "HMDID": {
              "description": "HMDB ID",
              "pattern": "HMDB[0-9]+",
              "type": "string"
            }
          },
          "required": [
            "Name"
          ]
        },
        "MicroRNA": {
          "description": "The microRNA",
          "type": "string"
        },
        "Number of genes": {
          "description": "Number of genes in the signature",
          "type": "number"
        },
        "Organism": {
          "description": "The organism (TODO: validate against official list)",
          "type": "string"
        },
        "Original String": {
          "description": "The original string recognized during processing",
          "type": "string"
        },
        "Other": {
          "$ref": "/@dcic/signature-commons-schema/meta/signature/perturbation/other.json",
          "description": "Other perturbations"
        },
        "PMID": {
          "description": "PubMed ID",
          "pattern": "[0-9]+",
          "type": "string"
        },
        "PTM": {
          "description": "Post translational modification",
          "type": "string"
        },
        "PWM": {
          "description": "Position Weight Matrices (PWMs)",
          "type": "string"
        },
        "Pathway": {
          "description": "The signature's pathway",
          "type": "Object",
          "properties": {
            "Name": {
              "description": "Name/ description of the pathway",
              "type": "string"
            },
            "Accession": {
              "description": "External accession of the pathway (Wiki Pathway ID/Pathway ID/KEGG ID)",
              "type": "string"
            }
          },
          "required": [
            "Name"
          ]
        },
        "Patient ID": {
          "description": "Patient Identifier",
          "type": "string"
        },
        "Perturbation ID": {
          "description": "The type of perturbation performed the study.",
          "type": "string"
        },
        "Perturbation Type": {
          "description": "The type of perturbation performed the study.",
          "type": "string"
        },
        "Phenotype": {
          "$ref": "/@dcic/signature-commons-schema/meta/signature/perturbation/phenotype.json",
          "description": "Phenotype perturbations"
        },
        "Program": {
          "description": "The program/project involved witht the signature",
          "type": "string"
        },
        "Protein Domain": {
          "description": "Structural protein domain.",
          "type": "string"
        },
        "Readout": {
          "description": "Readout context of the signature",
          "type": "object",
          "properties": {
            "Assay": {
              "description": "The assay (TODO: validate against official list)",
              "type": "string"
            },
            "Computational Method": {
              "description": "Algorithm used",
              "type": "string"
            },
            "Measurement": {
              "description": "Measurement used in the study (inherited from library)",
              "type": "string"
            },
            "Resource": {
              "description": "Resource used to gather the signature",
              "type": "string"
            }
          },
          "required": [
            "Assay"
          ]
        },
        "Sex": {
          "description": "the sex of the sample",
          "enum": [
            "female",
            "male"
          ],
          "type": "string"
        },
        "Small Molecule": {
          "$ref": "/@dcic/signature-commons-schema/meta/signature/perturbation/small-molecule.json",
          "description": "Small Molecule used in the study"
        },
        "Sub Category Code": {
          "description": "Sub-collection the signature belongs to",
          "enum": [
            "CGN",
            "CM"
          ],
          "type": "string"
        },
        "Systematic Name": {
          "description": "Alternative identifier",
          "type": "string"
        },
        "Table Number": {
          "description": "Figure/Table number from the published literature where the signature was extracted",
          "type": "string"
        },
        "Taxon": {
          "description": "The taxon involved in the study",
          "type": "string"
        },
        "Time Point": {
          "description": "Time points used in the study.",
          "type": "string"
        },
        "Tissue": {
          "description": "The tissue context",
          "type": "array",
          "items": {
            "type": "object",
            "properties": {
              "Name": {
                "description": "Name of the tissue",
                "type": "string"
              },
              "Accession": {
                "description": "Ontology accession",
                "type": "string"
              }
            },
            "required": [
              "Name"
            ]
          }
        },
        "Virus": {
          "$ref": "/@dcic/signature-commons-schema/meta/signature/perturbation/disease.json",
          "description": "Virus perturbations TODO: Merge with disease perturbations"
        }
      },
      "required": [
        "Number of genes",
        "Original String",
        "$validator"
      ],
      "oneOf": [
        {
          "required": [
            "Cell Line",
            "Direction",
            "Organism",
            "Perturbation Type",
            "Readout",
            "Tissue"
          ]
        },
        {
          "required": [
            "Cell Line",
            "Direction",
            "Organism",
            "Perturbation Type",
            "PMID",
            "Readout"
          ]
        },
        {
          "required": [
            "Accession",
            "Gene Set",
            "Organism",
            "Perturbation Type",
            "Readout"
          ]
        },
        {
          "required": [
            "Organism",
            "Perturbation Type",
            "Readout",
            "Cell Line"
          ]
        },
        {
          "required": [
            "Organism",
            "Perturbation Type",
            "Readout",
            "Tissue"
          ]
        },
        {
          "required": [
            "Disease",
            "Organism",
            "Perturbation Type",
            "Readout"
          ]
        },
        {
          "required": [
            "Organism",
            "Other",
            "Perturbation Type",
            "Readout"
          ]
        },
        {
          "required": [
            "Organism",
            "Perturbation Type",
            "Phenotype",
            "Readout"
          ]
        },
        {
          "required": [
            "Organism",
            "Pathway",
            "Perturbation Type",
            "Readout"
          ]
        },
        {
          "required": [
            "Accession",
            "Direction",
            "Gene",
            "Perturbation Type",
            "Readout"
          ]
        },
        {
          "required": ["Number of genes", "Original String", "Perturbation Type", "Readout", "$validator", "Direction", "Accession", "Cell Line", "Disease"]
        }
      ]
    }
  ]
}